@using WebApp.Services.Impl
@inject TableService TableService
@rendermode InteractiveServer

<table class="table__table">
    <thead class="table__head">
    <tr class="table__row">
        <th class="table__cell table__cell_primary table__cell_sticky_start table__cell_edge-padding" style="inset-inline-start: 0;">
            <div role="button" tabindex="0" class="table__sort">
                <div class="table__sort-content">Name</div>
                <div class="table__sort-indicator">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" class="sort-icon" fill="currentColor" stroke="none" aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16">
                            <path fill="currentColor" fill-rule="evenodd" d="M3.72 2.22a.75.75 0 0 1 1.06 0l3 3a.75.75 0 0 1-1.06 1.06L5 4.56v8.69a.75.75 0 0 1-1.5 0V4.56L1.78 6.28A.75.75 0 0 1 .72 5.22l3-3ZM11.75 14a.75.75 0 0 1-.53-.22l-3-3a.75.75 0 1 1 1.06-1.06L11 11.44V2.75a.75.75 0 0 1 1.5 0v8.69l1.72-1.72a.75.75 0 1 1 1.06 1.06l-3 3a.75.75 0 0 1-.53.22Z" clip-rule="evenodd"></path>
                        </svg>
                    </svg>
                </div>
            </div>
        </th>
        <th class="table__cell table__cell_edge-padding">Date created</th>
        <th class="table__cell table__cell_primary table__cell_edge-padding">
            <div role="button" tabindex="0" class="table__sort">
                <div class="table__sort-content">Status</div>
                <div class="table__sort-indicator">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14" class="sort-icon" fill="currentColor" stroke="none" aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16">
                            <path fill="currentColor" fill-rule="evenodd" d="M3.72 2.22a.75.75 0 0 1 1.06 0l3 3a.75.75 0 0 1-1.06 1.06L5 4.56v8.69a.75.75 0 0 1-1.5 0V4.56L1.78 6.28A.75.75 0 0 1 .72 5.22l3-3ZM11.75 14a.75.75 0 0 1-.53-.22l-3-3a.75.75 0 1 1 1.06-1.06L11 11.44V2.75a.75.75 0 0 1 1.5 0v8.69l1.72-1.72a.75.75 0 1 1 1.06 1.06l-3 3a.75.75 0 0 1-.53.22Z" clip-rule="evenodd">
                            </path>
                        </svg>
                    </svg>
                </div>
            </div>
        </th>
        <th class="table__cell table__cell_edge-padding">ID</th>
        <th class="table__cell table__cell_sticky_end table__cell_edge-padding" style="width: 28px; height:  18px; inset-inline-end: 0;">
        </th>
    </tr>
    </thead>
    <tbody class="table__body">
    @if (_scopes is null || !_scopes.Any())
    {
        <tr class="table__row table__row_empty">
            <td class="table__cell" colspan="5">No data</td>
        </tr>
    }
    else
    {
        @foreach (var scope in _scopes)
        {
            <tr class="table__row table__row_interactive">
                <td class="table__cell table__cell_primary table__cell_sticky_start table__cell_edge-padding" style="inset-inline-start: 0;">
                    <div class="table__copy">
                        <div class="table__copy-content">
                            <div class="cloud-overview__table-name">
                                <div class="cloud-overview__table-name-icon">
                                    <div class="table__scope-icon" style="color: rgb(255, 255, 255); background-color: @scope.IconColorHexCode;">
                                        <span>@scope.Name[..2].ToUpper()</span>
                                    </div>
                                </div>
                                <div class="cloud-overview__table-name-text" title="@scope.Name">@scope.Name</div>
                            </div>
                        </div>
                        <Table_ClipboardButton TextToCopy="@scope.Name"/>
                    </div>
                </td>
                <td class="table__cell table__cell_edge-padding">
                    <div class="cloud-overview__table-date" title="@scope.DateCreated.Date.ToString("d MMM yyyy")">@scope.DateCreated.Date.ToString("d MMM yyyy")</div>
                </td>
                <td class="table__cell table__cell_primary table__cell_edge-padding">
                    <div>
                        <div class="label label_theme_success">
                            <div class="label__text">
                                <div class="label__content">Active</div>
                            </div>
                        </div>
                    </div>
                </td>
                <td class="table__cell table__cell_edge-padding">
                    <div class="table__copy">
                        <div class="table__copy-content">
                            <div class="cloud-overview__table-id">@scope.Id</div>
                        </div>
                        <Table_ClipboardButton TextToCopy="@scope.Id"/>
                    </div>
                </td>
                <td class="table__cell table__cell_sticky_end table__cell_edge-padding" style="width: 28px; inset-inline-end: 0;">
                    <div class="table__actions">
                        <button aria-label="Actions" aria-expanded="false" aria-controls="g-:r56:" class="table__actions-button" type="button">
                            <span class="button__icon">
                                <span class="button__icon-inner">
                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" class="actions-icon" fill="currentColor" stroke="none" aria-hidden="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16">
                                            <path fill="currentColor" fill-rule="evenodd" d="M3 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM9.5 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm5 0a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z" clip-rule="evenodd">
                                            </path>
                                        </svg>
                                    </svg>
                                </span>
                            </span>
                        </button>
                    </div>
                </td>
            </tr>
        }
    }
    </tbody>
</table>

@code {
    private List<TableItem>? _scopes;

    protected override async Task OnInitializedAsync()
    {
        _scopes = await TableService.GetItemsAsync(CloudId);
    }

    [Parameter]
    public string CloudId { get; set; }
}